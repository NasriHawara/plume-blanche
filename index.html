<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plume Blanche | Luxury Beauty Lounge</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="bg-overlay"></div>

    <header>
        <div class="logo-container">
            <img src="https://customer-assets.emergentagent.com/job_hair-hub-12/artifacts/cprm0suq_0c1377bd-f4df-4c9c-922d-9f2e9eca59a7.jfif" alt="Plume Blanche Logo" class="logo-image">
        </div>
        <nav id="nav-links" class="hidden">
            <button class="btn-nav" onclick="showView('booking-section')">
                <i class="fas fa-calendar-plus"></i>
                <span>Book Now</span>
            </button>
            <button class="btn-nav" onclick="showView('client-profile-section')">
                <i class="fas fa-user-circle"></i>
                <span>My Profile</span>
            </button>
            <button class="btn-logout" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </nav>
    </header>

    <div id="app-container">

        <!-- AUTH SECTION -->
        <div id="auth-section" class="view">
            <div class="card auth-card">
                <div class="card-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <div class="card-header">
                    <h2 class="section-title" id="auth-title">Welcome Back</h2>
                    <p class="subtitle">Sign in to manage your beauty journey</p>
                </div>

                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="email" placeholder="Email Address">
                </div>

                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="password" placeholder="Password">
                </div>

                <div id="signup-extra" class="hidden">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="fullname" placeholder="Full Name">
                    </div>
                    <div class="input-group">
                        <i class="fas fa-phone"></i>
                        <input type="tel" id="phone" placeholder="Phone Number">
                    </div>
                </div>

                <button class="btn-primary btn-large" id="auth-action-btn">
                    <span>Login</span>
                    <i class="fas fa-arrow-right"></i>
                </button>

                <p class="toggle-link">
                    Don't have an account? <span id="toggle-text">Sign Up</span>
                </p>
            </div>
        </div>

        <!-- CLIENT PROFILE SECTION -->
        <div id="client-profile-section" class="view hidden">
            <div class="card">
                <div class="card-header">
                    <h2 class="section-title">
                        <i class="fas fa-user-circle"></i>
                        My Appointments
                    </h2>
                    <p class="subtitle">Track your beauty sessions</p>
                </div>

                <div class="profile-stats">
                    <div class="stat-card">
                        <i class="fas fa-gem"></i>
                        <span>Gold Member</span>
                    </div>
                </div>

                <div class="booking-filter-tabs">
                    <div class="tab active" onclick="filterClientBookings('upcoming')">
                        <i class="fas fa-calendar-check"></i>
                        <span>Upcoming</span>
                    </div>
                    <div class="tab" onclick="filterClientBookings('pending')">
                        <i class="fas fa-clock"></i>
                        <span>Pending</span>
                    </div>
                    <div class="tab" onclick="filterClientBookings('past')">
                        <i class="fas fa-history"></i>
                        <span>History</span>
                    </div>
                </div>

                <div id="client-bookings-list" class="list-container">
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <p>No appointments found</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOOKING SECTION -->
        <div id="booking-section" class="view hidden">
            <div class="card">
                <div class="card-header">
                    <h2 class="section-title">
                        <i class="fas fa-sparkles"></i>
                        Book Your Experience
                    </h2>
                    <p class="subtitle">Select your preferred date and services</p>
                </div>

                <div class="booking-step">
                    <div class="step-number">1</div>
                    <h3 class="step-label">Choose Your Date</h3>
                </div>

                <div class="input-group calendar-group">
                    <i class="fas fa-calendar-alt"></i>
                    <input type="date" id="date-picker">
                </div>

                <button class="btn-primary" onclick="detailsForm.classList.remove('hidden'); renderServiceCheckboxes();">
                    <span>Continue Booking</span>
                    <i class="fas fa-arrow-right"></i>
                </button>

                <div id="details-form" class="hidden">
                    <div class="divider">
                        <span>2</span>
                    </div>

                    <div class="booking-step">
                        <div class="step-number">2</div>
                        <h3 class="step-label">Select Your Services</h3>
                    </div>

                    <div id="service-checkbox-list" class="checkbox-group"></div>

                    <div class="divider">
                        <span>3</span>
                    </div>

                    <div class="booking-step">
                        <div class="step-number">3</div>
                        <h3 class="step-label">Choose Your Specialist</h3>
                    </div>

                    <div class="input-group">
                        <i class="fas fa-user-tie"></i>
                        <select id="tech-select">
                            <option value="" disabled selected>Select your preferred specialist...</option>
                        </select>
                    </div>

                    <div class="divider">
                        <span>4</span>
                    </div>

                    <div class="booking-step">
                        <div class="step-number">4</div>
                        <h3 class="step-label">Pick Your Time Slot</h3>
                    </div>

                    <div id="booking-summary" class="summary-box hidden">
                        <h4>
                            <i class="fas fa-clipboard-list"></i>
                            Booking Summary
                        </h4>
                        <div class="summary-row">
                            <span>Total Duration:</span>
                            <strong id="sum-duration">0</strong> <span>minutes</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total Price:</span>
                            <strong>$<span id="sum-price">0</span></strong>
                        </div>
                        <p style="margin-top: 15px; font-size: 0.85rem; color: var(--text-muted); font-style: italic;">
                            This session involves multiple specialists
                        </p>
                    </div>

                    <div id="time-slots" class="time-grid"></div>

                    <button class="btn-primary hidden" id="book-now-btn">
                        <span>Confirm Booking</span>
                        <i class="fas fa-check-circle"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- ADMIN SECTION -->
        <div id="admin-section" class="view hidden">
            <div class="card admin-card">
                <h1 class="page-title">
                    <i class="fas fa-crown"></i>
                    Admin Dashboard
                </h1>

                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="switchAdminTab('schedule')">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('requests')">
                        <i class="fas fa-bell"></i>
                        <span>Requests</span>
                        <span id="pending-count-badge" class="badge hidden">0</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('staff')">
                        <i class="fas fa-users"></i>
                        <span>Staff</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('services')">
                        <i class="fas fa-concierge-bell"></i>
                        <span>Services</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('history')">
                        <i class="fas fa-user-clock"></i>
                        <span>Client History</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('reminders')">
                        <i class="fas fa-comments"></i>
                        <span>Reminders</span>
                    </button>
                    <button class="tab-btn" onclick="switchAdminTab('reports')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </button>
                </div>

                <!-- SCHEDULE TAB -->
                <div id="admin-tab-schedule" class="admin-tab-content">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-calendar-week"></i>
                            Daily Schedule
                        </h3>
                        <p>Manage appointments and availability</p>
                    </div>

                    <div class="admin-filters">
                        <div class="filter-group">
                            <label class="filter-label">DATE</label>
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="admin-date-filter" class="filter-input">
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">SPECIALIST</label>
                            <i class="fas fa-user-tie"></i>
                            <select id="admin-tech-filter" class="filter-input">
                                <option value="all">All Specialists</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">CATEGORY</label>
                            <i class="fas fa-tags"></i>
                            <select id="admin-service-filter" class="filter-input">
                                <option value="all">All Categories</option>
                            </select>
                        </div>
                    </div>

                    <div class="laser-panel">
                        <div class="laser-info">
                            <i class="fas fa-bolt"></i>
                            <span>Laser Services Control</span>
                        </div>
                        <button class="btn-laser" id="laser-toggle-btn" onclick="toggleLaserForDate()">
                            Enable for Selected Date
                        </button>
                    </div>

                    <div class="view-controls">
                        <button class="btn-view-toggle active" onclick="switchView('daily')">
                            <i class="fas fa-calendar-day"></i>
                            <span>Daily View</span>
                        </button>
                        <button class="btn-view-toggle" onclick="switchView('weekly')">
                            <i class="fas fa-calendar-week"></i>
                            <span>Weekly View</span>
                        </button>
                    </div>

                    <div id="daily-view" class="scheduler-container">
                        <div id="scheduler-grid" class="scheduler-grid"></div>
                    </div>

                    <div id="weekly-view" class="hidden">
                        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 20px;">
                            <button class="btn-primary" style="width: auto; padding: 12px 24px;" onclick="changeWeek(-1)">
                                <i class="fas fa-chevron-left"></i>
                                <span>Previous Week</span>
                            </button>
                            <button class="btn-primary" style="width: auto; padding: 12px 24px;" onclick="changeWeek(1)">
                                <span>Next Week</span>
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div id="weekly-calendar" class="weekly-preview-grid"></div>
                    </div>
                </div>

                <!-- REQUESTS TAB -->
                <div id="admin-tab-requests" class="admin-tab-content hidden">
                    <div id="admin-inbox"></div>
                </div>

                <!-- STAFF TAB -->
                <div id="admin-tab-staff" class="admin-tab-content hidden">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-users-cog"></i>
                            Staff Management
                        </h3>
                        <p>Manage team members and their skills</p>
                    </div>

                    <div class="management-two-column">
                        <div class="mgmt-column">
                            <div class="mgmt-card">
                                <div class="mgmt-header">
                                    <i class="fas fa-user-plus"></i>
                                    <h3>Add New Staff</h3>
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-user"></i>
                                    <input type="text" id="new-staff-name" placeholder="Full Name">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-envelope"></i>
                                    <input type="email" id="new-staff-email" placeholder="Email">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-phone"></i>
                                    <input type="tel" id="new-staff-phone" placeholder="Phone">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-lock"></i>
                                    <input type="password" id="new-staff-password" placeholder="Password">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-user-tag"></i>
                                    <select id="new-staff-role">
                                        <option value="specialist">Specialist</option>
                                        <option value="admin">Admin</option>
                                    </select>
                                </div>
                                <button class="btn-primary" onclick="addStaff()">
                                    <span>Add Staff Member</span>
                                    <i class="fas fa-plus"></i>
                                </button>
                                <p style="margin-top: 15px; font-size: 0.85rem; color: var(--text-muted); text-align: center;">
                                    <i class="fas fa-info-circle"></i>
                                    System will generate a secure password and link user account automatically
                                </p>
                            </div>
                        </div>

                        <div class="mgmt-column">
                            <div class="mgmt-card">
                                <div class="mgmt-header">
                                    <i class="fas fa-users"></i>
                                    <h3>Staff Members</h3>
                                </div>
                                <div id="staff-list-container"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SERVICES TAB -->
                <div id="admin-tab-services" class="admin-tab-content hidden">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-concierge-bell"></i>
                            Services Management
                        </h3>
                        <p>Manage services and categories</p>
                    </div>

                    <div class="management-two-column">
                        <div class="mgmt-column">
                            <div class="mgmt-card">
                                <div class="mgmt-header">
                                    <i class="fas fa-plus-circle"></i>
                                    <h3>Add New Service</h3>
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-tag"></i>
                                    <input type="text" id="new-service-name" placeholder="Service Name">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-folder"></i>
                                    <select id="new-service-category">
                                        <option value="">Select or Add New Category...</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-dollar-sign"></i>
                                    <input type="number" id="new-service-price" placeholder="Price">
                                </div>
                                <div class="input-group">
                                    <i class="fas fa-clock"></i>
                                    <input type="number" id="new-service-dur" placeholder="Duration (minutes)">
                                </div>
                                <div class="checkbox-item" style="margin: 20px 0;">
                                    <input type="checkbox" id="new-service-confirm">
                                    <span>Requires Approval</span>
                                </div>
                                <button class="btn-primary" onclick="addService()">
                                    <span>Add Service</span>
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>

                        <div class="mgmt-column">
                            <div class="mgmt-card">
                                <div class="mgmt-header">
                                    <i class="fas fa-list"></i>
                                    <h3>Service Menu</h3>
                                </div>
                                <div id="service-list-container"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CLIENT HISTORY TAB -->
                <div id="admin-tab-history" class="admin-tab-content hidden">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-user-clock"></i>
                            Client History
                        </h3>
                        <p>Search and view client booking history</p>
                    </div>

                    <div class="input-group" style="max-width: 600px; margin: 0 auto 30px;">
                        <i class="fas fa-search"></i>
                        <input type="text" id="client-search-input" placeholder="Search by name or phone number">
                    </div>

                    <div id="client-history-results"></div>
                </div>

                <!-- REMINDERS TAB -->
                <div id="admin-tab-reminders" class="admin-tab-content hidden">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-comment-dots"></i>
                            WhatsApp Reminders
                        </h3>
                        <p>Send appointment reminders to clients and staff</p>
                    </div>

                    <div class="admin-filters">
                        <div class="filter-group">
                            <label class="filter-label">FILTER BY DATE</label>
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="reminder-date-filter" class="filter-input" onchange="renderReminders()">
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">REMINDER TYPE</label>
                            <i class="fas fa-filter"></i>
                            <select id="reminder-type-filter" class="filter-input" onchange="renderReminders()">
                                <option value="all">All Reminders</option>
                                <option value="client">Client Reminders</option>
                                <option value="staff">Staff Reminders</option>
                            </select>
                        </div>
                    </div>

                    <div id="reminders-list"></div>
                </div>

                <!-- REPORTS TAB (NEW) -->
                <div id="admin-tab-reports" class="admin-tab-content hidden">
                    <div class="card-subheader">
                        <h3>
                            <i class="fas fa-chart-line"></i>
                            Business Reports
                        </h3>
                        <p>Comprehensive analytics and insights</p>
                    </div>

                    <div class="admin-filters">
                        <div class="filter-group">
                            <label class="filter-label">REPORT TYPE</label>
                            <i class="fas fa-chart-bar"></i>
                            <select id="report-type-filter" class="filter-input" onchange="generateReport()">
                                <option value="daily">Daily Report</option>
                                <option value="weekly">Weekly Report</option>
                                <option value="monthly">Monthly Report</option>
                                <option value="yearly">Yearly Report</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">SELECT DATE</label>
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="report-date-filter" class="filter-input" onchange="generateReport()">
                        </div>
                    </div>

                    <button class="btn-primary" onclick="generateReport()" style="max-width: 300px; margin: 20px auto;">
                        <i class="fas fa-sync-alt"></i>
                        <span>Generate Report</span>
                    </button>

                    <div id="report-container"></div>
                </div>
            </div>
        </div>

        <!-- SPECIALIST SECTION -->
        <div id="specialist-section" class="view hidden">
            <div class="card admin-card">
                <h1 class="page-title">
                    <i class="fas fa-calendar-week"></i>
                    My Schedule
                </h1>
                <p class="subtitle">View your upcoming appointments</p>

                <div class="specialist-filters">
                    <div class="filter-group">
                        <label class="filter-label">SELECT DATE</label>
                        <i class="fas fa-calendar-alt"></i>
                        <input type="date" id="specialist-date-filter" class="filter-input">
                    </div>
                </div>

                <div id="specialist-calendar-container" class="calendar-container"></div>
            </div>
        </div>

    </div>

    <!-- CONFIRMATION MODAL -->
    <div id="confirm-modal" class="modal">
        <div class="modal-backdrop" onclick="confirmModal.classList.remove('active')"></div>
        <div class="modal-content">
            <div class="success-icon">
                <i class="fas fa-check"></i>
            </div>
            <h3>Booking Confirmed!</h3>
            <p id="modal-msg">Your appointment has been confirmed successfully!</p>
            <button class="btn-primary" onclick="confirmModal.classList.remove('active'); showView('client-profile-section')">
                <span>View My Bookings</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- SKILLS MODAL -->
    <div id="skills-modal" class="modal">
        <div class="modal-backdrop" onclick="closeSkillsModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <h3 id="skills-modal-title">Manage Skills</h3>
            <div id="skills-checkbox-list" class="checkbox-group" style="max-height: 400px;"></div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" onclick="saveStaffSkills()">
                    <span>Save Skills</span>
                    <i class="fas fa-check"></i>
                </button>
                <button class="btn-reject" onclick="closeSkillsModal()">
                    <span>Cancel</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ADMIN BOOKING MODAL -->
    <div id="admin-booking-modal" class="modal">
        <div class="modal-backdrop" onclick="closeAdminBookingModal()"></div>
        <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
            <h3>
                <i class="fas fa-calendar-plus"></i>
                Create Appointment
            </h3>
            
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" id="admin-client-name" placeholder="Client Name">
            </div>
            
            <div class="input-group">
                <i class="fas fa-phone"></i>
                <input type="tel" id="admin-client-phone" placeholder="Client Phone">
            </div>
            
            <div class="input-group">
                <i class="fas fa-calendar-alt"></i>
                <input type="date" id="admin-booking-date">
            </div>
            
            <div class="input-group">
                <i class="fas fa-user-tie"></i>
                <select id="admin-booking-tech">
                    <option value="">Choose specialist...</option>
                </select>
            </div>

            <div class="form-label">SELECT SERVICES</div>
            <div id="admin-service-checkbox-list" class="checkbox-group" style="max-height: 300px;"></div>

            <div class="form-label">SELECT TIME SLOT</div>
            <div id="admin-time-slots" class="time-grid" style="max-height: 250px;"></div>

            <div id="admin-booking-details" class="summary-box hidden"></div>

            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" onclick="confirmAdminBooking()">
                    <span>Confirm Booking</span>
                    <i class="fas fa-check"></i>
                </button>
                <button class="btn-reject" onclick="closeAdminBookingModal()">
                    <span>Cancel</span>
                </button>
            </div>
        </div>
    </div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { 
        getDatabase, ref, set, onValue, push, remove, get, update,
        query, orderByChild, equalTo 
    } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
    import { 
        getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, 
        signOut, onAuthStateChanged 
    } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAQFPrIm-nM64S1vx8ge-GVIVMm7vb6oS0",
        authDomain: "plume-blanche.firebaseapp.com",
        databaseURL: "https://plume-blanche-default-rtdb.firebaseio.com",
        projectId: "plume-blanche",
        storageBucket: "plume-blanche.firebasestorage.app",
        messagingSenderId: "74569715679",
        appId: "1:74569715679:web:584e870612e5491111fe6a"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const auth = getAuth(app);

    // Export to window
    window.db = database;
    window.dbRef = ref;
    window.dbSet = set;
    window.dbOnValue = onValue;
    window.dbPush = push;
    window.dbRemove = remove;
    window.dbGet = get;
    window.dbUpdate = update;
    window.dbQuery = query;
    window.orderByChild = orderByChild;
    window.equalTo = equalTo;
    window.auth = auth;
    window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.signOut = signOut;
    window.onAuthStateChanged = onAuthStateChanged;

    console.log("Firebase initialized successfully!");
</script>

    <script src="script.js"></script>
</body>
</html>
